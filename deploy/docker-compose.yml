version: '3.8'

services:
  chat_node1:
    build:
      context: ..
      dockerfile: deploy/Dockerfile
    container_name: chat_node1
    hostname: chat_node1
    command: python -m src.node --config configs/node1.yml
    ports:
      - "5001:5001"
    volumes:
      - node1_data:/data/logs
    networks:
      - chat_network
    restart: unless-stopped

  chat_node2:
    build:
      context: ..
      dockerfile: deploy/Dockerfile
    container_name: chat_node2
    hostname: chat_node2
    command: python -m src.node --config configs/node2.yml
    ports:
      - "5002:5002"
    volumes:
      - node2_data:/data/logs
    networks:
      - chat_network
    restart: unless-stopped

  chat_node3:
    build:
      context: ..
      dockerfile: deploy/Dockerfile
    container_name: chat_node3
    hostname: chat_node3
    command: python -m src.node --config configs/node3.yml
    ports:
      - "5003:5003"
    volumes:
      - node3_data:/data/logs
    networks:
      - chat_network
    restart: unless-stopped

networks:
  chat_network:
    driver: bridge

volumes:
  node1_data:
  node2_data:
  node3_data:

